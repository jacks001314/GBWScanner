#!/bin/bash

# resolve links - $0 may be a softlink
THIS="$0"
while [ -h "$THIS" ]; do
  ls=`ls -ld "$THIS"`
  link=`expr "$ls" : '.*-> \(.*\)$'`
  if expr "$link" : '.*/.*' > /dev/null; then
    THIS="$link"
  else
    THIS=`dirname "$THIS"`/"$link"
  fi
done

# if no args specified, show usage
if [ $# = 0 ]; then
  echo "Usage: GBWScanner COMMAND"
  echo "where COMMAND is one of:"
  echo "tcp		 					send/recv tcp packets"
  exit 1
fi

# get arguments
COMMAND=$1
shift

# some directories
THIS_DIR=`dirname "$THIS"`
#GBWScanner_HOME=`cd "$THIS_DIR/.." ; pwd`

GBWScanner_JOB=/opt/antell/GBWScanner/lib/GBWScanner-1.0.jar


# figure out which class to run
if [ "$COMMAND" = "tcp" ] ; then
    CLASS=com.gbw.scanner.plugins.detect.tcp.TCPUtils
else
    CLASS=$COMMAND
fi

EXEC_CALL="java jar $GBWScanner_JOB"


# run it
exec $EXEC_CALL $CLASS "$@"

